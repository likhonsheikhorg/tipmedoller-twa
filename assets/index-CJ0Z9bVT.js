import{u as B,r as o,A as L,j as e,S as n,H as r,M as z,a as S,L as _,b as R,c as a,C as g,d as v,T as h,e as F,B as K,I as N,F as W,f as A,m as T,g as D}from"./index-P0oc4blE.js";import{R as X,A as Y,X as $,Y as G,T as P,a as q}from"./AreaChart-Dq_w5xpa.js";import"./clsx-B-dksMZM.js";function U(){var y,w;const j=B(),i=o.useContext(L),[l,f]=o.useState(null),[u,x]=o.useState("month"),c={today:"за 24 часа",week:"за неделю",month:"за месяц",year:"за год"},[d,b]=o.useState(null),[m,C]=o.useState("current"),p=o.useRef(null),[I,M]=o.useState(void 0),E=async()=>{var t;f(null);const s=await A.get("/dashboard/stats/dynamic",{date:u,timezone:T.tz.guess()},(t=i.props.auth)==null?void 0:t.token);if(s.errors){D(s.errors,j);return}f(s.data)},H=async()=>{var t;b(null);const s=await A.get("/dashboard/stats/total",{month:m,timezone:T.tz.guess()},(t=i.props.auth)==null?void 0:t.token);if(s.errors){D(s.errors,j);return}b(s.data)};return o.useEffect(()=>{E()},[u]),o.useEffect(()=>{H()},[m]),o.useEffect(()=>{p.current&&M(p.current.clientHeight)},[l,d]),e.jsxs(n,{direction:"column",spacing:4,children:[e.jsx(r,{children:"обзор"}),e.jsxs(n,{direction:["column","row"],spacing:3,w:"full",children:[e.jsxs(n,{maxW:["full","60%"],w:"full",direction:"column",spacing:3,ref:p,children:[e.jsxs(n,{bgColor:"#202020",direction:"column",spacing:3,p:4,borderRadius:"lg",w:"full",h:"280px",children:[e.jsxs(n,{direction:["column","row"],spacing:2,alignItems:["start","center"],justifyContent:"space-between",children:[e.jsx(r,{size:"md",children:"динамика"}),e.jsxs(z,{children:[e.jsx(S,{children:e.jsx(_,{color:"brand.300",fontSize:"sm",children:c[u]})}),e.jsxs(R,{bgColor:"#202020",children:[e.jsx(a,{bgColor:"#202020",_hover:{bgColor:"#252525"},onClick:()=>{x("week")},children:c.week}),e.jsx(a,{bgColor:"#202020",_hover:{bgColor:"#252525"},onClick:()=>{x("month")},children:c.month}),e.jsx(a,{bgColor:"#202020",_hover:{bgColor:"#252525"},onClick:()=>{x("year")},children:c.year})]})]})]}),l?e.jsx(e.Fragment,{children:l.length!==0?e.jsx(X,{width:"100%",height:"100%",children:e.jsxs(Y,{height:300,data:l.map(s=>({name:s.date,amount:s.amount/100})),children:[e.jsx($,{fontSize:"12px",dataKey:"name"}),e.jsx(G,{}),e.jsx(P,{content:({active:s,payload:t})=>{var k;return s&&t&&t.length?e.jsxs(n,{direction:"column",spacing:0,bgColor:"#252525",borderRadius:"md",p:2,children:[e.jsx(h,{fontSize:"xs",opacity:"0.5",children:t[0].payload.name}),e.jsxs(r,{size:"sm",children:[t[0].value," ",(k=i.props.auth)==null?void 0:k.profile.default_currency]})]}):null}}),e.jsx(q,{type:"monotone",dataKey:"amount",stroke:"#800000",fill:"#800000"})]})}):e.jsx(g,{h:"full",children:e.jsx(h,{opacity:"0.5",children:"нет данных"})})}):e.jsx(g,{h:"full",children:e.jsx(v,{size:"xl",color:"brand.300"})})]}),e.jsxs(n,{bgColor:"#202020",direction:"column",spacing:3,p:4,borderRadius:"lg",w:"full",children:[e.jsxs(n,{direction:["column","row"],justifyContent:"space-between",alignItems:["start","center"],children:[e.jsx(r,{size:"md",children:"статистика"}),e.jsxs(z,{children:[e.jsx(S,{children:e.jsx(_,{color:"brand.300",fontSize:"sm",children:m==="current"?"за текущий месяц":"за предыдущий месяц"})}),e.jsxs(R,{bgColor:"#202020",children:[e.jsx(a,{bgColor:"#202020",_hover:{bgColor:"#252525"},onClick:()=>{C("current")},children:"за текущий месяц"}),e.jsx(a,{bgColor:"#202020",_hover:{bgColor:"#252525"},onClick:()=>{C("prev")},children:"за предыдущий месяц"})]})]})]}),d===null?e.jsx(g,{h:"full",children:e.jsx(v,{size:"xl",color:"brand.300"})}):e.jsxs(F,{columns:[1,2],spacing:3,children:[e.jsxs(n,{direction:"column",spacing:0,children:[e.jsxs(r,{size:"lg",children:[d.total/100," ",(y=i.props.auth)==null?void 0:y.profile.default_currency]}),e.jsx(h,{opacity:"0.5",children:"собрано"})]}),e.jsxs(n,{direction:"column",spacing:0,children:[e.jsx(r,{size:"lg",children:d.count}),e.jsx(h,{opacity:"0.5",children:"донатов"})]})]})]})]}),e.jsx(K,{maxW:["100%","40%"],w:"full",children:e.jsxs(n,{bgColor:"#202020",direction:"column",spacing:2,p:4,borderRadius:"lg",w:"full",h:I,children:[e.jsxs(n,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e.jsx(r,{size:"md",children:"недавние донаты"}),e.jsx(N,{"aria-label":"external",icon:e.jsx(W,{}),onClick:()=>{var s;window.open(`https://widget.tipmeadollar.com/last_donations?key=${(s=i.props.auth)==null?void 0:s.profile.api_token}`,"game","width=448,height=720,menu,menubar=no,toolbar=no,location=no,status=no")}})]}),e.jsx("iframe",{className:"s-index-last-alerts-iframe",src:`https://widget.tipmeadollar.com/last_donations?key=${(w=i.props.auth)==null?void 0:w.profile.api_token}`,style:{width:"100%",height:"100%"}})]})})]})]})}export{U as default};
