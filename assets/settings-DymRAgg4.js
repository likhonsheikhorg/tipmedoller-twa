import{r as j,A as q,u as T,h as A,j as e,S as x,H as b,C as W,d as E,k as o,l as a,x as H,n as h,y as N,z as O,I as L,D as P,p as R,o as l,E as v,G as C,J as $,q as B,f as S,g as k}from"./index-P0oc4blE.js";import{I as _}from"./InputSilder-WJJyUHLH.js";import"./chunk-TK6VMDNP-DTNDeJlA.js";function M(){var f,g,w,I;const c=j.useContext(q),p=T(),[D,y]=j.useState(),{register:u,handleSubmit:z,formState:{errors:s,isSubmitting:i},setValue:d,watch:n}=A(),F=async r=>{var t;const m=await S.post("/dashboard/page/edit",{...r,min_amount:(r.min_amount*100).toFixed(0),voice_min_amount:(r.voice_min_amount*100).toFixed(0),audio_min_amount:(r.audio_min_amount*100).toFixed(0)},(t=c.props.auth)==null?void 0:t.token);if(m.errors){k(m.errors,p);return}p({status:"success",title:"настройки сохранены!"})},V=async()=>{var m;const r=await S.get("/dashboard/page",void 0,(m=c.props.auth)==null?void 0:m.token);if(r.errors){k(r.errors,p);return}for(const t of Object.keys(r.page)){if(t==="blacklisted_words"){d(t,r.page[t].join(" ").trim());continue}if(t.endsWith("amount")){d(t,r.page[t]/100);continue}d(t,r.page[t])}y(r.page)};return j.useEffect(()=>{V()},[]),e.jsx("form",{onSubmit:z(F),children:e.jsxs(x,{direction:"column",spacing:4,children:[e.jsx(b,{children:"настройки"}),D?e.jsxs(e.Fragment,{children:[e.jsxs(x,{direction:"column",spacing:2,children:[e.jsx(b,{size:"md",children:"страница донатов"}),e.jsxs(o,{children:[e.jsx(a,{children:"ссылка"}),e.jsxs(H,{children:[e.jsx(h,{color:"brand.300",value:`https://tipmeadollar.com/p/${(f=c.props.auth)==null?void 0:f.profile.username}`,isReadOnly:!0,_focusVisible:{borderColor:"brand.500",boxShadow:"0 0 0 1px var(--aithercol-colors-brand-500)"},cursor:"pointer",onClick:()=>{var r;N(`https://tipmeadollar.com/p/${(r=c.props.auth)==null?void 0:r.profile.username}`)}}),e.jsx(O,{width:"3rem",children:e.jsx(L,{"aria-label":"copy",icon:e.jsx(P,{}),maxW:"1.75rem",minW:"1.75rem",variant:"ghost",h:"1.75rem",size:"sm",onClick:()=>{var r;window.navigator.clipboard.writeText(`https://tipmeadollar.com/p/${(r=c.props.auth)==null?void 0:r.profile.username}`),p({title:"cсылка скопирована"})}})})]})]}),e.jsxs(o,{isInvalid:!!s.description,children:[e.jsx(a,{children:"описание страницы"}),e.jsx(R,{isDisabled:i,placeholder:"введите описание",_focusVisible:{borderColor:"brand.500",boxShadow:"0 0 0 1px var(--aithercol-colors-brand-500)"},...u("description",{required:!1,maxLength:1e3})}),e.jsx(l,{error:s.description})]}),e.jsxs(o,{isInvalid:!!s.button_text,children:[e.jsx(a,{children:"текст кнопки"}),e.jsx(h,{isDisabled:i,placeholder:"введите текст",_focusVisible:{borderColor:"brand.500",boxShadow:"0 0 0 1px var(--aithercol-colors-brand-500)"},...u("button_text",{required:!1,maxLength:100})}),e.jsx(l,{text:'если значение не задано, на кнопке будет написано "отправить"',error:s.button_text})]})]}),e.jsxs(x,{direction:"column",spacing:2,children:[e.jsx(b,{size:"md",children:"настройки донатов"}),e.jsxs(o,{isInvalid:!!s.min_amount,children:[e.jsxs(a,{children:["минимальная сумма в"," ",(g=c.props.auth)==null?void 0:g.profile.default_currency]}),e.jsx(h,{isDisabled:i,placeholder:"введите минимальную сумму",_focusVisible:{borderColor:"brand.500",boxShadow:"0 0 0 1px var(--aithercol-colors-brand-500)"},...u("min_amount",{required:!1,valueAsNumber:!0,validate:r=>r>=0||"bad_number_with_zero"})}),e.jsx(l,{error:s.min_amount})]}),e.jsxs(o,{isInvalid:!!s.max_length,children:[e.jsx(a,{children:"максимальное количество символов в сообщение"}),e.jsx(_,{isDisabled:i,min:40,max:300,value:n("max_length"),onChange:r=>d("max_length",r)}),e.jsx(l,{error:s.max_length})]}),e.jsxs(o,{isInvalid:!!s.voice_enabled,children:[e.jsx(a,{fontWeight:"bold",children:"озвучка"}),e.jsx(v,{isDisabled:i,value:n("voice_enabled"),onToggle:()=>d("voice_enabled",!n("voice_enabled"))})]}),e.jsx(C,{in:n("voice_enabled"),animateOpacity:!0,children:e.jsxs(x,{direction:"column",spacing:2,children:[e.jsxs(o,{isInvalid:!!s.voice_volume_percent,children:[e.jsx(a,{children:"голос"}),e.jsxs($,{isDisabled:i,_focusVisible:{borderColor:"brand.500",boxShadow:"0 0 0 1px var(--aithercol-colors-brand-500)"},...u("voice_type",{required:!0}),children:[e.jsx("option",{value:"maxim",children:"Максим"}),e.jsx("option",{value:"tatiana",children:"Татьяна"}),e.jsx("option",{value:"ermil",children:"Ермил"}),e.jsx("option",{value:"anatoly",children:"Анатолий"}),e.jsx("option",{value:"svetlana",children:"Светлана"})]}),e.jsx(l,{error:s.voice_volume_percent})]}),e.jsxs(o,{isInvalid:!!s.voice_volume_percent,children:[e.jsx(a,{children:"громкость речи"}),e.jsx(_,{isDisabled:i,min:0,max:100,value:n("voice_volume_percent"),onChange:r=>d("voice_volume_percent",r),isPercent:!0}),e.jsx(l,{error:s.voice_volume_percent})]}),e.jsxs(o,{isInvalid:!!s.voice_speed,children:[e.jsx(a,{children:"скорость речи"}),e.jsx(_,{isDisabled:i,min:.25,max:1.5,step:.05,value:n("voice_speed"),onChange:r=>d("voice_speed",r)}),e.jsx(l,{error:s.voice_speed})]}),e.jsxs(o,{isInvalid:!!s.voice_min_amount,children:[e.jsxs(a,{children:["минимальная сумма в"," ",(w=c.props.auth)==null?void 0:w.profile.default_currency]}),e.jsx(h,{isDisabled:i,placeholder:"введите минимальную сумму",_focusVisible:{borderColor:"brand.500",boxShadow:"0 0 0 1px var(--aithercol-colors-brand-500)"},...u("voice_min_amount",{required:!1,valueAsNumber:!0,validate:r=>r>=0||"bad_number_with_zero"})}),e.jsx(l,{error:s.voice_min_amount})]})]})}),e.jsxs(o,{isInvalid:!!s.voice_enabled,children:[e.jsx(a,{fontWeight:"bold",children:"голосовые донаты"}),e.jsx(v,{isDisabled:i,value:n("audio_enabled"),onToggle:()=>d("audio_enabled",!n("audio_enabled"))})]}),e.jsx(C,{in:n("audio_enabled"),animateOpacity:!0,children:e.jsxs(x,{direction:"column",spacing:2,children:[e.jsxs(o,{isInvalid:!!s.audio_max_length,children:[e.jsx(a,{children:"максимальная длина"}),e.jsx(_,{isDisabled:i,min:10,max:120,step:1,value:n("audio_max_length"),onChange:r=>d("audio_max_length",r)}),e.jsx(l,{error:s.audio_max_length})]}),e.jsxs(o,{isInvalid:!!s.audio_min_amount,children:[e.jsxs(a,{children:["минимальная сумма в"," ",(I=c.props.auth)==null?void 0:I.profile.default_currency]}),e.jsx(h,{isDisabled:i,placeholder:"введите минимальную сумму",_focusVisible:{borderColor:"brand.500",boxShadow:"0 0 0 1px var(--aithercol-colors-brand-500)"},...u("audio_min_amount",{required:!1,valueAsNumber:!0,validate:r=>r>=0||"bad_number_with_zero"})}),e.jsx(l,{error:s.voice_min_amount})]})]})})]}),e.jsxs(x,{direction:"column",spacing:2,children:[e.jsx(b,{size:"md",children:"спам фильтр"}),e.jsxs(o,{isInvalid:!!s.remove_links,children:[e.jsx(a,{children:"удалять ссылки"}),e.jsx(v,{isDisabled:i,value:n("remove_links"),onToggle:()=>d("remove_links",!n("remove_links"))}),e.jsx(l,{text:"при включённой опции система будет пытаться удалять ссылки из виджетов",error:s.remove_links})]}),e.jsxs(o,{isInvalid:!!s.blacklisted_words,children:[e.jsx(a,{children:"чёрный список слов"}),e.jsx(h,{isDisabled:i,placeholder:"введите слова",_focusVisible:{borderColor:"brand.500",boxShadow:"0 0 0 1px var(--aithercol-colors-brand-500)"},...u("blacklisted_words",{required:!1})}),e.jsx(l,{error:s.blacklisted_words,text:"введите слова через пробел. Например: огурец помидор. запрещённые слова будут заменяться звёздочками"})]})]}),e.jsx(B,{type:"submit",isDisabled:i,children:"сохранить"})]}):e.jsx(W,{children:e.jsx(E,{color:"brand.300",size:"xl"})})]})})}export{M as default};
